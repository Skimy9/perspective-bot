# tests/personality/mbti.py
class MBTIPersonalityTest:
    category = "personality"
    name = "üîç –¢–∏–ø –ª–∏—á–Ω–æ—Å—Ç–∏ (MBTI)"
    description = "–£–ø—Ä–æ—â—ë–Ω–Ω—ã–π —Ç–µ—Å—Ç –ø–æ —Å–∏—Å—Ç–µ–º–µ –ú–∞–π–µ—Ä—Å-–ë—Ä–∏–≥–≥—Å"

    questions = [
        "–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—à—å –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è —Å –ª—é–¥—å–º–∏, –∞ –Ω–µ –≤ –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–µ?",
        "–ß–∞—â–µ –¥–æ–≤–µ—Ä—è–µ—à—å —Å–≤–æ–∏–º –æ—â—É—â–µ–Ω–∏—è–º, —á–µ–º –∏–Ω—Ç—É–∏—Ü–∏–∏?",
        "–í –ø—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏–π —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É–µ—à—å—Å—è –ª–æ–≥–∏–∫–æ–π, –∞ –Ω–µ —á—É–≤—Å—Ç–≤–∞–º–∏?",
        "–õ—é–±–∏—à—å –∏–º–µ—Ç—å –≤—Å—ë –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–æ–µ?",
        "–ó–∞—Ä—è–∂–∞–µ—à—å—Å—è —ç–Ω–µ—Ä–≥–∏–µ–π, –æ–±—â–∞—è—Å—å —Å –¥—Ä—É–≥–∏–º–∏?",
        "–¶–µ–Ω–∏—à—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–∫—Ç—ã –±–æ–ª—å—à–µ, —á–µ–º –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –∏–¥–µ–∏?",
        "–ù–∞ –ø–µ—Ä–≤–æ–µ –º–µ—Å—Ç–æ —Å—Ç–∞–≤–∏—à—å —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –∑–∞–¥–µ–≤–∞–µ—Ç —á—É–≤—Å—Ç–≤–∞?",
        "–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—à—å –∑–∞–≤–µ—Ä—à–∞—Ç—å –¥–µ–ª–∞ –≤–æ–≤—Ä–µ–º—è, –∞ –Ω–µ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–æ–º–µ–Ω—Ç?",
        "–ß–∞—â–µ –¥–µ–π—Å—Ç–≤—É–µ—à—å –∏–º–ø—É–ª—å—Å–∏–≤–Ω–æ, —á–µ–º –æ–±–¥—É–º–∞–Ω–Ω–æ?",
        "–õ–µ–≥–∫–æ –∑–∞–º–µ—á–∞–µ—à—å –¥–µ—Ç–∞–ª–∏ –≤ –æ–∫—Ä—É–∂–∞—é—â–µ–º –º–∏—Ä–µ?",
        "–ß–∞—â–µ –ø—Ä–∏–Ω–∏–º–∞–µ—à—å —Ä–µ—à–µ–Ω–∏—è, –¥—É–º–∞—è –æ –ª—é–¥—è—Ö, —á–µ–º –æ –ª–æ–≥–∏–∫–µ?",
        "–õ—é–±–∏—à—å –æ—Å—Ç–∞–≤–ª—è—Ç—å –ø–ª–∞–Ω—ã –≥–∏–±–∫–∏–º–∏ –∏ –∏–º–ø—Ä–æ–≤–∏–∑–∏—Ä–æ–≤–∞—Ç—å?"
    ]

    # –û—Ç–≤–µ—Ç—ã: 0 = "–ù–µ—Ç", 1 = "–î–∞"
    # –î–ª—è MBTI: –î–∞ = +1 –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —à–∫–∞–ª–µ
    options = [
        ["–ù–µ—Ç", "–î–∞"],  # E
        ["–ù–µ—Ç", "–î–∞"],  # S
        ["–ù–µ—Ç", "–î–∞"],  # T
        ["–ù–µ—Ç", "–î–∞"],  # J
        ["–ù–µ—Ç", "–î–∞"],  # E
        ["–ù–µ—Ç", "–î–∞"],  # S
        ["–ù–µ—Ç", "–î–∞"],  # T
        ["–ù–µ—Ç", "–î–∞"],  # J
        ["–ù–µ—Ç", "–î–∞"],  # P (J vs P)
        ["–ù–µ—Ç", "–î–∞"],  # S
        ["–ù–µ—Ç", "–î–∞"],  # F
        ["–ù–µ—Ç", "–î–∞"]   # P (J vs P)
    ]

    # –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–æ–≤ —Å —à–∫–∞–ª–∞–º–∏: 0=E, 1=S, 2=T, 3=J
    SCALE_MAP = [0, 1, 2, 3, 0, 1, 2, 3, 3, 1, 2, 3]  # 12 –≤–æ–ø—Ä–æ—Å–æ–≤

    @classmethod
    def interpret(cls, answers: list) -> dict:
        """
        –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ (0 –∏–ª–∏ 1)
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
        """
        if len(answers) != len(cls.questions):
            raise ValueError("–ù–µ–≤–µ—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤")

        # –°—á—ë—Ç—á–∏–∫–∏ –ø–æ —à–∫–∞–ª–∞–º: [E, S, T, J]
        scores = [0, 0, 0, 0]

        for i, answer_idx in enumerate(answers):
            scale = cls.SCALE_MAP[i]
            if answer_idx == 1:  # "–î–∞" = +1
                scores[scale] += 1

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø
        e_i = "E" if scores[0] >= 2 else "I"
        s_n = "S" if scores[1] >= 2 else "N"
        t_f = "T" if scores[2] >= 2 else "F"
        j_p = "J" if scores[3] >= 2 else "P"

        type_code = e_i + s_n + t_f + j_p

        descriptions = {
            "INTJ": "–°—Ç—Ä–∞—Ç–µ–≥ (–∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä) ‚Äî –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π, –∞–Ω–∞–ª–∏—Ç–∏—á–Ω—ã–π, –¥–∞–ª—å–Ω–æ–≤–∏–¥–Ω—ã–π",
            "INTP": "–õ–æ–≥–∏–∫ ‚Äî –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã–π, —Ç–µ–æ—Ä–µ—Ç–∏–∫, –Ω–æ–≤–∞—Ç–æ—Ä",
            "ENTJ": "–ö–æ–º–∞–Ω–¥–∏—Ä ‚Äî –ª–∏–¥–µ—Ä, —Ä–µ—à–∏—Ç–µ–ª—å–Ω—ã–π, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–π",
            "ENTP": "–ü–æ–ª–µ–º–∏—Å—Ç ‚Äî –æ—Å—Ç—Ä–æ—É–º–Ω—ã–π, –∏–∑–æ–±—Ä–µ—Ç–∞—Ç–µ–ª—å–Ω—ã–π, —Å–ø–æ—Ä—â–∏–∫",
            "INFJ": "–ê–∫—Ç–∏–≤–∏—Å—Ç ‚Äî –∏–¥–µ–∞–ª–∏—Å—Ç, –∑–∞–±–æ—Ç–ª–∏–≤—ã–π, –≥–ª—É–±–æ–∫–∏–π",
            "INFP": "–ü–æ—Å—Ä–µ–¥–Ω–∏–∫ ‚Äî –º–µ—á—Ç–∞—Ç–µ–ª—å, –∏—Å–∫—Ä–µ–Ω–Ω–∏–π, —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π",
            "ENFJ": "–ù–∞—Å—Ç–∞–≤–Ω–∏–∫ ‚Äî —Ö–∞—Ä–∏–∑–º–∞—Ç–∏—á–Ω—ã–π, –∑–∞–±–æ—Ç–ª–∏–≤—ã–π, –ª–∏–¥–µ—Ä",
            "ENFP": "–ë–æ—Ä–µ—Ü ‚Äî —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–π, –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–π, –æ–ø—Ç–∏–º–∏—Å—Ç",
            "ISTJ": "–ó–∞—â–∏—Ç–Ω–∏–∫ ‚Äî –Ω–∞–¥—ë–∂–Ω—ã–π, –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π",
            "ISFJ": "–ö–æ–Ω—Å—É–ª ‚Äî –∑–∞–±–æ—Ç–ª–∏–≤—ã–π, —Ç–µ—Ä–ø–µ–ª–∏–≤—ã–π, –≤–µ—Ä–Ω—ã–π",
            "ESTJ": "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä ‚Äî –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–π, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π, –ø—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω—ã–π",
            "ESFJ": "–ö–æ–Ω—Å—É–ª ‚Äî –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –∑–∞–±–æ—Ç–ª–∏–≤—ã–π, —Å–æ—Ü–∏–∞–ª—å–Ω—ã–π",
            "ISTP": "–í–∏—Ä—Ç—É–æ–∑ ‚Äî —Å–ø–æ–∫–æ–π–Ω—ã–π, –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π, –ª—é–±–∏—Ç –¥–µ–π—Å—Ç–≤–∏—è",
            "ISFP": "–ê–≤–∞–Ω—Ç—é—Ä–∏—Å—Ç ‚Äî –º—è–≥–∫–∏–π, —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π, –∂–∏–≤—ë—Ç –∑–¥–µ—Å—å –∏ —Å–µ–π—á–∞—Å",
            "ESTP": "–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å ‚Äî —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–π, —Å–º–µ–ª—ã–π, –ª—é–±–∏—Ç —Ä–∏—Å–∫–æ–≤–∞—Ç—å",
            "ESFP": "–†–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å ‚Äî –∂–∏–∑–Ω–µ—Ä–∞–¥–æ—Å—Ç–Ω—ã–π, –æ–±—â–∏—Ç–µ–ª—å–Ω—ã–π, —Å–ø–æ–Ω—Ç–∞–Ω–Ω—ã–π"
        }

        result = descriptions.get(type_code, "–£–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–∏–ø ‚Äî —Å–æ—á–µ—Ç–∞–Ω–∏–µ —á–µ—Ä—Ç —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤")

        return {
            "result": f"–í–∞—à —Ç–∏–ø –ª–∏—á–Ω–æ—Å—Ç–∏: {type_code} ‚Äî {result}",
            "advice": (
                f"–í—ã ‚Äî {type_code}. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã:\n"
                f"‚Ä¢ {'–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Ç' if 'E' in type_code else '–ò–Ω—Ç—Ä–æ–≤–µ—Ä—Ç'}\n"
                f"‚Ä¢ {'–û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —Ñ–∞–∫—Ç—ã' if 'S' in type_code else '–û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ –∏–¥–µ–∏'}\n"
                f"‚Ä¢ {'–†—É–∫–æ–≤–æ–¥—Å—Ç–≤—É–µ—Ç–µ—Å—å –ª–æ–≥–∏–∫–æ–π' if 'T' in type_code else '–†—É–∫–æ–≤–æ–¥—Å—Ç–≤—É–µ—Ç–µ—Å—å —á—É–≤—Å—Ç–≤–∞–º–∏'}\n"
                f"‚Ä¢ {'–ü–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∂–∏–∑–Ω—å' if 'J' in type_code else '–ò–º–ø—Ä–æ–≤–∏–∑–∏—Ä—É–µ—Ç–µ'}\n\n"
                "–¢–µ—Å—Ç –Ω–æ—Å–∏—Ç –æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ç–∏–ø–∞—Ö –ª–∏—á–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –≤ –∫–Ω–∏–≥–∞—Ö –ø–æ MBTI."
            )
        }